(this["webpackJsonpsv-variant-vis"]=this["webpackJsonpsv-variant-vis"]||[]).push([[0],{229:function(e,t,a){},248:function(e,t){},250:function(e,t){},271:function(e,t,a){"use strict";a.r(t);var n,r=a(2),c=a.n(r),i=a(39),l=a.n(i),o=(a(229),a(6)),s=a.n(o),u=a(51),m=a(3),d=a(4),p=a(36),f=a(25),h=a(5),g=function(e){var t=e.wrapperWidth,a=e.wrapperHeight,n=e.xStart,r=e.xEnd,i=e.yPosition,l=e.stepSize,o=e.axisObject,s=e.axisTitle;return c.a.createElement(c.a.Fragment,null,c.a.createElement("path",{d:"M ".concat(n," ").concat(i," H ").concat(r," "),stroke:"currentColor",strokeWidth:"1"}),o.map((function(e){var t=e.value,a=e.offset;return c.a.createElement("g",{key:t,transform:"translate(".concat(n+a+.5*l,", ").concat(i,")")},c.a.createElement("line",{y1:"0",y2:"5",x:a,stroke:"black"}),c.a.createElement("text",{className:"axis-tick-text x-axis-tick-text",key:t},t))})),c.a.createElement("text",{transform:"translate(".concat(t/2,", ").concat(a,")")},s))},v=function(e){var t=e.wrapperHeight,a=e.yStart,n=e.yEnd,r=e.xPosition,i=e.axisObject,l=e.axisTitle;return c.a.createElement(c.a.Fragment,null,c.a.createElement("path",{d:"M ".concat(r," ").concat(a," V ").concat(n),stroke:"currentColor",strokeWidth:"1"}),i.map((function(e){var t=e.value,a=e.offset;return c.a.createElement("g",{key:t,transform:"translate(0, ".concat(a,")")},c.a.createElement("line",{x1:"45",x2:r,y:t,stroke:"black"}),c.a.createElement("text",{className:"axis-tick-text y-axis-tick-text",key:t},t))})),c.a.createElement("text",{transform:"translate(".concat(r-40,", ").concat(t/2,") rotate(270)")},l))},b=function(e){var t=e.data,a=e.chromosomes,n=e.wrapperWidth,r=e.wrapperHeight,i=e.title,l=e.pathLevels,o=e.colourMap,s=e.leftOffset,u=e.selectedChrom,m={top:25,right:0,bottom:35,left:s},d=n-m.left-m.right,b=r-m.top-m.bottom,y=t.map((function(e){return Object(f.sum)(l.map((function(t){return parseInt(e[t])})))})),E=p.d().keys(l)(t),k=p.a().domain(a).range([m.left,d+m.left]).padding([.15]),O=p.b().domain([0,Math.max.apply(Math,Object(h.a)(y))]).range([b+m.top,m.top]),S=l.map((function(e){return o[e]})),w=p.c().domain(l).range(S),x=a.map((function(e,t){return{value:e,offset:k.step()*t}})),C=O.ticks().map((function(e){return{value:e,offset:O(e)}}));return c.a.createElement("svg",{width:n,height:r},c.a.createElement("text",{transform:"translate(".concat(n/2,", ").concat(m.top/2,")"),className:"chart-title"},i),E.map((function(e,t){return e.map((function(e){var a;if(e.data.Chromosome!==u)a=null;else{var n=l.map((function(t){return e.data[t]})).filter((function(e){return"0"!==e}));a=t===n.length-1?[k.bandwidth()+2,0,O(e[0])-O(e[1])-2,k.bandwidth(),O(e[0])-O(e[1])+2,0]:[0,k.bandwidth(),O(e[0])-O(e[1]),0]}return c.a.createElement("rect",{key:"".concat(e.data.Chromosome," ").concat(e.data.ClinicalSignificance),width:k.bandwidth(),x:k(e.data.Chromosome),y:O(e[1]),height:O(e[0])-O(e[1]),fill:w(l[t]),stroke:e.data.Chromosome===u?"black":null,strokeWidth:"2px",strokeDasharray:a})}))})),c.a.createElement(g,{wrapperWidth:n,wrapperHeight:r,xStart:m.left,xEnd:m.left+d,yPosition:m.top+b,stepSize:k.step(),axisObject:x,axisTitle:"Chromosome"}),c.a.createElement(v,{wrapperHeight:r,yStart:m.top,yEnd:m.top+b,xPosition:m.left,axisObject:C,axisTitle:"# of Variants"}))},y=a(112),E=function(e){var t=e.width,a=e.selectedChrom,n=e.pathLevels,i=e.colourMap,l=e.selectedLevels,o=Object(r.useRef)(null),s=Object(r.useMemo)((function(){return{spacing:10,views:[{static:!0,layout:"circular",centerRadius:.5,tracks:[{alignment:"overlay",style:{background:"lightgray",backgroundOpacity:.2},data:{url:"https://raw.githubusercontent.com/armtsf/tmp/main/all_hg.csv",type:"csv",chromosomeField:"CHROM",genomicFields:["POS","END"]},mark:"rect",color:{field:"TYPE",type:"nominal",domain:["DEL","INS"],range:["#BDBDBD","#636363"]},x:{field:"POS",type:"genomic"},stroke:{value:i["All variants"]},strokeWidth:{value:1},width:t,height:10,tracks:[{mark:"rect"},{mark:"brush",x:{linkingId:"detail"},color:{value:"steelBlue"}}]},{alignment:"overlay",tracks:[{data:{url:"/CPSC_547_Structural_Variants/data/allmatched_clean.tsv",type:"csv",separator:"\t",chromosomeField:"CHROM",genomicFields:["POS","END"]},dataTransform:[{type:"filter",field:"ClinicalSignificance",oneOf:l}],mark:"rect",color:{field:"ClinicalSignificance",type:"nominal",domain:n,range:n.map((function(e){return i[e]}))},x:{field:"POS",type:"genomic"},stroke:{field:"ClinicalSignificance",type:"nominal",domain:n,range:n.map((function(e){return i[e]}))},strokeWidth:{value:1},tracks:[{mark:"rect"},{mark:"brush",x:{linkingId:"detail"},color:{value:"steelBlue"}}]},{alignment:"overlay",data:{type:"csv",url:"https://raw.githubusercontent.com/armtsf/tmp/main/matched-new.csv",separator:"\t",genomicFieldsToConvert:[{chromosomeField:"chr1",genomicFields:["p1s","p1e"]},{chromosomeField:"chr2",genomicFields:["p2s","p2e"]}]},dataTransform:[{type:"filter",field:"ClinicalSignificance",oneOf:l}],mark:"withinLink",x:{field:"p1s",type:"genomic"},xe:{field:"p1e",type:"genomic"},x1:{field:"p2s",type:"genomic"},x1e:{field:"p2e",type:"genomic"},stroke:{field:"ClinicalSignificance",type:"nominal",domain:n,range:n.map((function(e){return i[e]}))},strokeWidth:{value:1}}],width:t,height:30}]},{spacing:10,arrangement:"horizontal",tracks:[{id:"linear-track",data:{type:"csv",separator:"\t",url:"CPSC_547_Structural_Variants/data/allmatched_clean.tsv",chromosomeField:"CHROM",genomicFields:["POS","END"]},dataTransform:[{type:"filter",field:"ClinicalSignificance",oneOf:l}],mark:"rect",x:{field:"POS",type:"genomic",linkingId:"detail"},xe:{field:"END",type:"genomic"},color:{field:"ClinicalSignificance",type:"nominal",domain:n,range:n.map((function(e){return i[e]}))},stroke:{field:"ClinicalSignificance",type:"nominal",domain:n,range:n.map((function(e){return i[e]}))},strokeWidth:{value:3},width:t,height:100,tooltip:[{field:"POS",type:"genomic",alt:"Start Position"},{field:"END",type:"genomic",alt:"End Position"},{field:"SVTYPE",type:"nominal",alt:"SV Type"},{field:"ClinicalSignificance",type:"nominal",alt:"Clinical Significance"},{field:"Similarity",type:"continuous",alt:"Similarity"}]}]}]}}),[t,i,n,l]);Object(r.useEffect)((function(){o.current&&o.current.api.getViewIds().includes("linear-track")&&(a?o.current.api.zoomTo("linear-track","chr".concat(a)):o.current.api.zoomToExtent("linear-track"))}),[a]);var u=Object(y.b)(s);if("error"!==u.state)return c.a.createElement(y.a,{spec:s,padding:0,ref:o,experimental:{reactive:!0}});console.warn("Gosling spec is invalid!",u.messages)},k=function(e){var t=e.colourMap,a=Object.keys(t);return c.a.createElement("div",null,c.a.createElement("h3",{className:"text-center"},"Clinical Significance"),c.a.createElement("div",{className:"legend-colours sidebar-margin-left"},a.map((function(e){return c.a.createElement("div",{className:"legend-element",key:e},c.a.createElement("div",{style:{background:t[e]},className:"legend-bubble"}),c.a.createElement("p",null,e))}))))},O=a(97),S=function(e){var t=e.value,a=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}(e.colourMap[t]),n=Object(m.a)(a,3),r=n[0],i=n[1],l=n[2];return c.a.createElement("td",null,c.a.createElement("p",{style:{backgroundColor:"rgba(".concat(r,", ").concat(i,", ").concat(l,", 0.75)")},className:"clinical-significance"},t))},w=a(91),x=function(e){var t=e.value;return c.a.createElement("td",null,c.a.createElement("div",{style:{width:"".concat(t,"%"),backgroundColor:"grey",height:"1.375em"},className:"similarity"}))},C=[10,20,30].map((function(e){return{value:e,label:"Show ".concat(e)}})),j=function(e){var t=e.columns,a=e.data,n=e.colourMap,r=(e.pathLevels,Object(O.useTable)({columns:t,data:a,disableMultiSort:!1,initialState:{pageIndex:0}},O.useSortBy,O.usePagination)),i=r.getTableProps,l=r.getTableBodyProps,o=r.headerGroups,s=r.prepareRow,u=r.page,m=r.canPreviousPage,d=r.canNextPage,p=r.pageOptions,f=r.pageCount,h=r.gotoPage,g=r.nextPage,v=r.previousPage,b=r.setPageSize,y=r.state.pageIndex;return c.a.createElement("div",{className:"container match-table-container"},c.a.createElement("h2",null,"HG002 Matches"),c.a.createElement("table",Object.assign({},i(),{className:"match-table"}),c.a.createElement("thead",null,o.map((function(e){return c.a.createElement("tr",e.getHeaderGroupProps(),e.headers.map((function(e){return c.a.createElement("th",e.getHeaderProps(e.getSortByToggleProps()),e.render("Header"),c.a.createElement("span",null,e.isSorted?e.isSortedDesc?" \ud83d\udd3d":" \ud83d\udd3c":""))})))}))),c.a.createElement("tbody",l(),u.map((function(e,t){return s(e),c.a.createElement("tr",e.getRowProps(),e.cells.map((function(e){return"ClinicalSignificance"===e.column.id?c.a.createElement(S,{key:e.value,value:e.value,colourMap:n}):"Similarity"===e.column.id?c.a.createElement(x,{key:e.value,value:e.value}):c.a.createElement("td",e.getCellProps(),e.render("Cell"))})))})))),c.a.createElement("div",{className:"match-table-controls"},c.a.createElement("button",{onClick:function(){return h(0)},disabled:!m,className:"match-table-button"},"<<"),c.a.createElement("button",{onClick:function(){return v()},disabled:!m,className:"match-table-button"},"<"),c.a.createElement("button",{onClick:function(){return g()},disabled:!d,className:"match-table-button"},">"),c.a.createElement("button",{onClick:function(){return h(f-1)},disabled:!d,className:"match-table-button"},">>"),c.a.createElement("span",null,"Page"," ",c.a.createElement("strong",null,y+1," of ",p.length)),c.a.createElement("span",{className:"match-table-jump-to"},"Go to page: "),c.a.createElement("input",{type:"number",defaultValue:y+1,onChange:function(e){var t=e.target.value?Number(e.target.value)-1:0;h(t)}}),c.a.createElement(w.a,{options:C,onChange:function(e){return b(e.value)},defaultValue:{value:10,label:"Show 10"}})))},P=function(e){var t=.9*window.innerWidth*e,a=1260*e;return t>a?a:t},N=Object(f.range)(1,23).map((function(e){return"".concat(e)})).concat(["X","Y"]),H=[{value:null,label:"All"}],M=Object(d.a)(N);try{for(M.s();!(n=M.n()).done;){var _=n.value;H.push({value:_,label:"Chromosome ".concat(_)})}}catch(V){M.e(V)}finally{M.f()}var W=["Uncertain significance","Benign","Likely pathogenic","Pathogenic"],T={"All variants":"#818589","Uncertain significance":"#0092D0",Benign:"#4dac26","Likely pathogenic":"#eb95df",Pathogenic:"#d01c8b"};var L=function(){var e=Object(r.useState)([]),t=Object(m.a)(e,2),a=t[0],n=t[1],i=Object(r.useState)([]),l=Object(m.a)(i,2),o=l[0],d=l[1],h=Object(r.useState)(null),g=Object(m.a)(h,2),v=g[0],y=g[1],O=Object(r.useState)(null),S=Object(m.a)(O,2),x=S[0],C=S[1],M=Object(r.useState)(W),_=Object(m.a)(M,2),L=_[0],V=_[1],B=Object(r.useState)(!0),D=Object(m.a)(B,2),I=D[0],F=D[1],R=Object(r.useState)(P(.6)),z=Object(m.a)(R,2),G=z[0],A=z[1],Y=Object(r.useState)({wrapperWidth:P(.4),wrapperHeight:P(.2)}),J=Object(m.a)(Y,2),U=J[0],X=J[1];Object(r.useEffect)((function(){var e=function(){var e=Object(u.a)(s.a.mark((function e(){var t,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.e("/CPSC_547_Structural_Variants/data/clinvar_counts_by_chromosome.tsv");case 2:t=e.sent,a=t.filter((function(e){return N.includes(e.Chromosome)})),n(a);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),Object(r.useEffect)((function(){var e=function(){var e=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.e("/CPSC_547_Structural_Variants/data/hg002_matches_counts_by_chromosome.tsv");case 2:t=e.sent,d(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),Object(r.useEffect)((function(){var e=function(){var e=Object(u.a)(s.a.mark((function e(){var t,a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F(!0),e.next=3,p.e("/CPSC_547_Structural_Variants/data/allmatched_clean.tsv");case 3:t=e.sent,a=t.filter((function(e){return L.includes(e.ClinicalSignificance)})),x?(n=a.filter((function(e){return e.CHROM===x})),y(n)):y(a),F(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[x,L]),Object(r.useEffect)((function(){var e=function(){A(.54*window.innerWidth>756?756:.54*window.innerWidth),X({wrapperWidth:.36*window.innerWidth>540?540:.36*window.innerWidth,wrapperHeight:.2*window.innerWidth>224?224:.2*window.innerWidth})};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]);var $=Object(r.useMemo)((function(){return function(e,t,a,n){return Object(f.indexOf)(W,e.original[a])>Object(f.indexOf)(W,t.original[a])?1:-1}}),[]),q=Object(r.useMemo)((function(){return function(e,t,a,n){return Object(f.indexOf)(N,e.original[a])>Object(f.indexOf)(N,t.original[a])?1:-1}}),[]),K=Object(r.useMemo)((function(){return[{Header:"Chr",accessor:"CHROM",sortType:q},{Header:"Position",accessor:"POS"},{Header:"Type",accessor:"SVTYPE"},{Header:"Clinical Significance",accessor:"ClinicalSignificance",sortType:$},{Header:"Similarity",accessor:"Similarity"},{Header:"Allele ID",accessor:"AlleleID",disableSortBy:!0},{Header:"Associated Phenotypes",accessor:"PhenotypeList",disableSortBy:!0},{Header:"Gene",accessor:"HGNC_ID",disableSortBy:!0}]}),[]);return c.a.createElement(c.a.Fragment,null,c.a.createElement("h1",null,"Structural Variant Pathogenicity"),c.a.createElement("main",{className:"container dashboard"},c.a.createElement(E,{width:G,selectedChrom:x,selectedLevels:L,pathLevels:W,colourMap:T}),c.a.createElement("section",{className:"side"},c.a.createElement(k,{colourMap:T}),c.a.createElement("div",{className:"sidebar-margin-left"},c.a.createElement("div",{className:"select-levels"},c.a.createElement("h3",null,"Select Pathogenicity"),W.map((function(e){return c.a.createElement("label",{key:e},c.a.createElement("input",{type:"checkbox",checked:(t=e,L.includes(t)),onChange:function(t){return function(e,t){if(L.includes(t)){var a=L.filter((function(e){return e!==t}));V(a)}else{var n=L.concat(t),r=Object(f.sortBy)(n,(function(e){return Object(f.indexOf)(W,e)}));V(r)}}(0,e)}}),e);var t}))),c.a.createElement("h3",null,"Navigate to Chromosome"),c.a.createElement(w.a,{options:H,defaultValue:{value:null,label:"All"},onChange:function(e){C(e.value)}})),a.length>0&&c.a.createElement(b,{data:a,chromosomes:N,pathLevels:L,colourMap:T,title:"ClinVar Variants",wrapperWidth:U.wrapperWidth,wrapperHeight:U.wrapperHeight,leftOffset:50,selectedChrom:x}),o.length>0&&c.a.createElement(b,{data:o,chromosomes:N,pathLevels:L,colourMap:T,title:"HG002 Matches",wrapperWidth:U.wrapperWidth,wrapperHeight:U.wrapperHeight,leftOffset:50,selectedChrom:x}))),I?c.a.createElement("p",{className:"text-center"},"Loading matches..."):c.a.createElement(j,{columns:K,data:v,colourMap:T,pathLevels:W}))};l.a.render(c.a.createElement(L,null),document.getElementById("root"))}},[[271,1,2]]]);
//# sourceMappingURL=main.e3fbf861.chunk.js.map